<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Google Sheet</title>
    <link href="{{ url_for('style', path='styles.css') }}" rel="stylesheet">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<form name="sheet_form"  class="form-style-9" action="/sheet_submission" method="post">
<ul>
<li>
    <input type="url" name="sheets_url" class="field-style field-full align-none" placeholder="google_sheet_url" />

    <input type="url" name="phantom_csv" class="field-style field-full align-none" placeholder="phantom_csv" />

</li>
<li>
<input type="submit"  onclick="popup()" value="Send" />
<input name="goolge_account" type="submit" formaction="/google_connection" value="Use Google Account" />
</li>
   <li>
        <a href="/sheet_url"> Go to Sheet URL Form ---> </a>
   </li>
   <li>
       <a href="/airtable_form"> Go to Airtable Form---> </a>
   </li>
</ul>

</form>


<h2  style="text-align:left; padding-left: 400px">
    Managing data resulting from Phantom Buster tasks
</h2>
<p style="text-align:left; padding-left: 400px">
    This is a brief tutorial to get the information resulting from Phantom Buster tasks. You will be able <br>
to manage the information in Google Sheets and update new entries while the PB task is still running. <br>
To use this solution, you have to have one Phantom Buster task running with at least one result in the CSV.
    <span>

    </span>
</p>
<br>
<h2  style="text-align:left; padding-left: 400px" >
    How to use the above form
</h2>
<p style="text-align:left; padding-left: 400px">
    Please, fill in all the parameters:
    <br>
    <b> - google_sheet_url:</b>it’s the URL from Google Sheets
    <br>
    <br>
    <b> - phantom_csv:</b>it’s the CSV link from the Phantom Buster task. You can go to Phantom Buster and right-click
    <br>to copy the download link of the results CSV.
    <br>
    <br>
    After filling in all the information, click <b>Send</b>. If the response is <b>“Task scheduled successfully” </b>, it’s all done!
</p>
</body>

<script>

function popup() {
         let phantom_csv = document.forms["sheet_form"]["phantom_csv"].value
         let sheets_url = document.forms["sheet_form"]["sheets_url"].value
         if (phantom_csv == null || sheets_url != null){
             window.open('', Swal.fire({
                    icon: 'error',
                    title: 'Oops... This is Bad',
                    text: 'There is a wrong with your phantom_csv or sheets_url name'
                }), 'width=400,height=400,resizeable,scrollbars');
             document.forms["sheet_form"].target= Swal.fire({
                    icon: 'error',
                    title: 'Oops... This is Bad',
                    text: 'There is a wrong with your phantom_csv or sheets_url'
                });
         }
        fetch('/sheet_submission').then((response) => {
        console.log(response.status); // Will show you the status
        if (!response.ok) {
            {
                window.open('', Swal.fire({
                    icon: 'error',
                    title: 'Oops... This is Bad',
                    text: 'There is a wrong with your phantom_csv or sheets_url name'
                }), 'width=400,height=400,resizeable,scrollbars');
                form.target = Swal.fire({
                    icon: 'error',
                    title: 'Oops... This is Bad',
                    text: 'There is a wrong with your phantom_csv or sheets_url'
                });
            }
        }
    });
}
</script>
</html>